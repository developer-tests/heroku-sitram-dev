(()=>{"use strict";var e={n:t=>{var c=t&&t.__esModule?()=>t.default:()=>t;return e.d(c,{a:c}),c},d:(t,c)=>{for(var o in c)e.o(c,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:c[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.plugins,c=window.wp.apiFetch;var o=e.n(c);const s=window.wp.data,a=window.wp.element,r=window.wp.url,n=window.wc.blocksCheckout;(0,t.registerPlugin)("yith-sales-cart-discount-manager",{render:()=>{const e=(0,s.useSelect)((e=>e("wc/store/cart").getCartData())),t=(e=>{let t=0;return e.items.forEach((e=>{const c=e.totals;t+="yes"===yith_sales_cart_discount_block.display_prices_including_tax?parseInt(c.line_subtotal)+parseInt(c.line_subtotal_tax):parseInt(c.line_subtotal)})),c=t,o=e.totals.currency_minor_unit,parseInt(c,10)/10**o;var c,o})(e);(0,a.useEffect)((()=>{e.items.length>0&&o()({path:(0,r.addQueryArgs)("/yith_sales/v1/campaigns/check-cart-discount",{cart_subtotal:t}),method:"GET",cache:"no-store"}).then((t=>{t?.campaign&&!1!==t.campaign?(e=>{const t=e.coupons.filter((e=>e.code===yith_sales_cart_discount_block.coupon_code)).shift();t?.code||o()({path:(0,r.addQueryArgs)("/wc/store/v1/cart/apply-coupon",{code:yith_sales_cart_discount_block.coupon_code,context:"yith_sales_block"}),method:"POST",cache:"no-store"}).then((e=>{(0,s.dispatch)("wc/store/cart").receiveCart(e)})).catch((e=>{(0,s.dispatch)("wc/store/cart").receiveError(e)}))})(e):(e=>{const t=e.coupons.filter((e=>e.code===yith_sales_cart_discount_block.coupon_code)).shift();t?.code&&o()({path:(0,r.addQueryArgs)("/wc/store/v1/cart/remove-coupon",{code:yith_sales_cart_discount_block.coupon_code,context:"yith_sales_block"}),method:"POST",cache:"no-store"}).then((e=>{(0,s.dispatch)("wc/store/cart").receiveCart(e)})).catch((e=>{(0,s.dispatch)("wc/store/cart").receiveError(e)}))})(e)}))}),[e])},scope:"woocommerce-checkout"}),(0,n.registerCheckoutFilters)("yith-sales-rename-coupon",{coupons:e=>e.map((e=>{const t=(0,s.select)("wc/store/cart").getCartData(),c=""!==t.extensions?.yith_sales_wc_block_manager?.yith_sales_coupon_label;if(e.code!==yith_sales_cart_discount_block.coupon_code&&c)return e;let o=t.extensions.yith_sales_wc_block_manager.yith_sales_coupon_label;return{...e,label:o}}))})})();