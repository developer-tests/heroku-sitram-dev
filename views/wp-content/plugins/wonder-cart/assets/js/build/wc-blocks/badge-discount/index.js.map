{"version":3,"file":"wc-blocks/badge-discount/index.js","mappings":"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","sources":["webpack://wonder-cart/external window [\"wc\",\"blocksCheckout\"]","webpack://wonder-cart/external window [\"wp\",\"data\"]","webpack://wonder-cart/external window [\"wp\",\"element\"]","webpack://wonder-cart/external window [\"wp\",\"plugins\"]","webpack://wonder-cart/webpack/bootstrap","webpack://wonder-cart/webpack/runtime/compat get default export","webpack://wonder-cart/webpack/runtime/define property getters","webpack://wonder-cart/webpack/runtime/hasOwnProperty shorthand","webpack://wonder-cart/webpack/runtime/make namespace object","webpack://wonder-cart/./includes/wc-blocks/assets/js/badge-discount/index.js"],"sourcesContent":["module.exports = window[\"wc\"][\"blocksCheckout\"];","module.exports = window[\"wp\"][\"data\"];","module.exports = window[\"wp\"][\"element\"];","module.exports = window[\"wp\"][\"plugins\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { registerCheckoutFilters } from '@woocommerce/blocks-checkout';\nimport { useSelect } from '@wordpress/data';\nimport { useEffect } from '@wordpress/element';\nimport { registerPlugin } from '@wordpress/plugins';\n\nconst modifyCartItemClass = (defaultValue, extensions, args) => {\n  const campaignsData = args.cartItem?.item_data ? args.cartItem.item_data.filter(data => data.name === 'yith-campaigns-applied') : [];\n  if (campaignsData.length > 0) {\n    return defaultValue + ' yith-sales-item-width-badge--' + args.cartItem.key;\n  }\n  return defaultValue;\n};\n\nregisterCheckoutFilters('yith-sales-cart-item-class', {\n  cartItemClass: modifyCartItemClass\n});\n\nconst render = () => {\n  const cartItems = useSelect((select) => select('wc/store/cart').getCartData().items);\n\n  useEffect(() => {\n    setTimeout(function () {\n      const cartHtml = document.querySelector('.wc-block-cart__main') || document.querySelector('.wc-block-components-order-summary__content');\n      if (cartHtml !== null) {\n        const oldBadges = cartHtml.querySelectorAll('.yith-cart-sales-badge');\n        oldBadges.forEach(oldBadge => {\n          oldBadge.remove();\n        });\n        const elementsWithBadge = cartHtml.querySelectorAll('[class*=yith-sales-item-width-badge]');\n        elementsWithBadge.forEach(elementWithBadge => {\n          const classList = Array.from(elementWithBadge.classList);\n          const className = classList.filter(classList => classList.includes('yith-sales-item-width-badge')).shift();\n          const itemID = className.split('--')[1];\n\n          const items = cartItems.filter(cartItem => cartItem.key === itemID);\n          let item = false;\n          if (items.length > 1) {\n            item = items.filter(item => item.item_data.filter(data => data.name === 'yith-campaigns-applied').length === 1).shift();\n          } else {\n            item = items.shift();\n          }\n          const campaignsData = item ? item.item_data.filter(data => data.name === 'yith-campaigns-applied') : [];\n          if (campaignsData.length > 0) {\n            const names = campaignsData[0].value.split(',');\n            names.forEach(name => {\n              const id = name.toLowerCase().replaceAll(' ', '-');\n              if (!elementWithBadge.querySelector('#b' + id)) {\n                const badgeHtml = document.createElement('div');\n                badgeHtml.id = 'b' + id;\n                badgeHtml.className = 'yith-cart-sales-badge wc-block-components-product-badge wc-block-components-sale-badge';\n                badgeHtml.innerHTML = '<span>' + name + '</span>';\n                badgeHtml.style = 'margin-right:5px';\n\n                if (Array.from(cartHtml.classList).includes('wc-block-components-order-summary__content')) {\n                  elementWithBadge.querySelector('.wc-block-components-order-summary-item__description').insertBefore(badgeHtml, elementWithBadge.querySelector('.wc-block-components-order-summary-item__description').children[1]);\n                } else {\n                  elementWithBadge.querySelector('.wc-block-cart-item__wrap').insertBefore(badgeHtml, elementWithBadge.querySelector('.wc-block-cart-item__wrap').children[2]);\n                }\n              }\n            });\n          }\n        });\n      }\n    }, 500);\n  }, [cartItems]);\n};\nregisterPlugin('yith-sales-badge-discount', {\n  render,\n  scope: 'woocommerce-checkout'\n});\n"],"names":["registerCheckoutFilters","useSelect","useEffect","registerPlugin","modifyCartItemClass","defaultValue","extensions","args","campaignsData","cartItem","item_data","filter","data","name","length","key","cartItemClass","render","cartItems","select","getCartData","items","setTimeout","cartHtml","document","querySelector","oldBadges","querySelectorAll","forEach","oldBadge","remove","elementsWithBadge","elementWithBadge","classList","Array","from","className","includes","shift","itemID","split","item","names","value","id","toLowerCase","replaceAll","badgeHtml","createElement","innerHTML","style","insertBefore","children","scope"],"sourceRoot":""}